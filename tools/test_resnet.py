#-*-coding:utf-8-*-
import torch
from mmdet.models.backbones.preresnet import PResNet

cfg = [49, 51, 60, 121, 199, 27, 22, 31, 55, 62, 50, 121, 128, 214, 254, 24, 79, 118,
       110, 120, 125, 128, 127, 155, 256, 256, 562, 371, 6, 27, 66, 85, 171, 117, 20,
       55, 72, 33, 100, 66, 131, 183, 113, 124, 177, 83, 173, 236, 122, 187, 245, 122,
       141, 247, 126, 198, 248, 123, 195, 239, 156, 188, 217, 128, 197, 214, 106, 201, 215, 148,
       164, 184, 131, 168, 159, 115, 193, 213, 201, 219, 210, 210, 243, 239, 216, 248, 251, 287,
       250, 248, 238, 255, 256, 324, 512, 512, 2032, 2047, 509, 512, 2045, 512, 512, 2044]

model = PResNet(depth=101,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        style='pytorch',
        cfg = cfg)

print(model)